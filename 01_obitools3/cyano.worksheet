<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>CurrentWorkingDirectory</key>
	<string>/Users/yiwang</string>
	<key>WorksheetContents</key>
	<string>obi import --quality-sanger Cyano/201007_SN234_A_L001__AQHH-28_AdapterTrimmed_R1.fastq cyano/reads1

obi import --quality-sanger Cyano/201007_SN234_A_L001__AQHH-28_AdapterTrimmed_R2.fastq cyano/reads2

obi alignpairedend -R cyano/reads2 cyano/reads1 cyano/aligned_reads

obi grep -a mode:alignment cyano/aligned_reads cyano/good_sequences
# 17654206 lines left

obi import --ngsfilter cyano_data/ngsfilter_cyano.txt cyano/ngsfile

obi ngsfilter -t cyano/ngsfile -u cyano/unidentified_sequences cyano/good_sequences cyano/identified_sequences
# 8305339 lines left


obi grep -p "sequence['score_norm']&gt;=0.4" cyano/identified_sequences cyano/identified_sequences_filtered
# Grepped 8281996 entries


obi uniq -m sample cyano/identified_sequences_filtered cyano/dereplicated_sequences_filtered
# 5490874 lines left


obi annotate -k COUNT -k MERGED_sample cyano/dereplicated_sequences_filtered cyano/cleaned_metadata_sequences_filtered


obi grep -p "sequence['COUNT']&gt;=10" cyano/cleaned_metadata_sequences_filtered cyano/denoised_sequences_filtered
# Grepped 30248 entries 



obi clean -s MERGED_sample -r 0.2 -H cyano/denoised_sequences_filtered cyano/cleaned_sequences_r2
#r2: 19809 lines left




# Obitools3 commands to process raw amplicon sequence data for input into metabaR R package
# Dataset CYA

obi ecotag -m 0.95 --taxonomy database/silva/taxonomy/my_tax \
-R database/silva/ref_16s_CYA359F_784R_db_99 \
cyano/cleaned_sequences_r2 cyano/silva_95_assigned_sequences_r2




obi grep -A SCIENTIFIC_NAME cyano/silva_95_assigned_sequences_r2 cyano/silva_95_assigned_sequences_r2_for_metabaR
#Grepped 16545 entries






## motu table
obi annotate --taxonomy silva/taxonomy/my_tax \
--with-taxon-at-rank superkingdom \
--with-taxon-at-rank kingdom \
--with-taxon-at-rank phylum \
--with-taxon-at-rank subphylum \
--with-taxon-at-rank class \
--with-taxon-at-rank subclass \
--with-taxon-at-rank order \
--with-taxon-at-rank suborder \
--with-taxon-at-rank infraorder \
--with-taxon-at-rank superfamily \
--with-taxon-at-rank family \
--with-taxon-at-rank genus \
--with-taxon-at-rank species \
--with-taxon-at-rank subspecies \
cyano/silva_95_assigned_sequences_r2_for_metabaR cyano/silva_95_assigned_sequences_r2_for_metabaR_taxInfo


## take only motus assigned as bacteria
obi grep -a superkingdom_name:Bacteria cyano/silva_95_assigned_sequences_r2_for_metabaR_taxInfo \
cyano/silva_95_assigned_sequences_r2_for_metabaR_taxInfo_bac
# Grepped 9576 entries


obi annotate \
-k BEST_IDENTITY -k TAXID -k SCIENTIFIC_NAME -k COUNT -k seq_length \
-k superkingdom_name \
-k kingdom_name \
-k phylum_name \
-k subphylum_name \
-k class_name \
-k subclass_name \
-k order_name \
-k suborder_name \
-k infraorder_name \
-k superfamily_name \
-k family_name \
-k genus_name \
-k species_name \
cyano/silva_95_assigned_sequences_r2_for_metabaR_taxInfo_bac cyano/silva_95_assigned_sequences_r2_for_metabaR_motus


obi export --tab-output cyano/silva_95_assigned_sequences_r2_for_metabaR_motus &gt; cyano_r2_silva_95_motus.txt


## reads table
obi annotate -k MERGED_sample cyano/silva_95_assigned_sequences_r2_for_metabaR_taxInfo_bac \
cyano/silva_95_assigned_sequences_r2_for_metabaR_reads

obi export --tab-output --output-na-string 0 cyano/silva_95_assigned_sequences_r2_for_metabaR_reads \
&gt; cyano_r2_silva_95_reads.txt


</string>
</dict>
</plist>
